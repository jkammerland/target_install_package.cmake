#!/bin/bash
# Alpine Linux package build helper script
# Generated by CMake target_configure_universal_packaging

set -e

echo "Building Alpine Linux package..."

# Validate APKBUILD
if [[ ! -f APKBUILD ]]; then
    echo "Error: APKBUILD not found"
    exit 1
fi

# Check dependencies
echo "Checking build dependencies..."
if ! apk info -e $(source APKBUILD; printf '%s\n' $makedepends) > /dev/null 2>&1; then
    echo "Installing missing build dependencies..."
    sudo apk add $(source APKBUILD; printf '%s\n' $makedepends)
fi

# Build package
echo "Building package..."
abuild -F -r

echo "Package built successfully!"
echo "Install with: sudo apk add ~/packages/[arch]/[repo]/*.apk"